<%= button_to 'Back to subs list', subs_path, method: :get %>
<p>Author: <%= link_to @post.author.username, user_path(@post.author) %></p>
<p>Title: <%= @post.title %></p>
<p>Url: <%= @post.url %></p>
<p>Content: <%= @post.content %></p>
<p>Cross-posted in Subs:
  <ul>
    <% @post.sub_ids.each do |sub_id| %>
      <li><%=link_to Sub.find(sub_id).name, sub_path(Sub.find(sub_id)) %></li>
    <% end %>
  </ul>
</p>

<% if @post.author == current_user %>
  <%= button_to 'Edit post', edit_post_path(@post), method: :get %>
  <%= button_to 'Delete post', post_path(@post), method: :delete %>
<% end %>

<div style="border-style: dashed; display: inline-block; padding: 10px 10px 10px 10px;">
  <p>Add comment:</p>
  <%= render 'comments/form', comment: @post.comments.new, parent_comment: nil %>
</div>

<p><b><%= "Comments(#{@post.comments.count})"%></b></p>

<p>
  <% @all_comments.where.not(parent_comment_id: nil).each do |top_level_comment| %>

    <% child_comments = @all_comments.where(parent_comment_id: top_level_comment.id) %>
    <ul style="list-style-type: none;">
      <li><%= render 'comments/comment', comment: top_level_comment, child_comments: child_comments %></li>
    </ul>
  <% end %>
</p>
